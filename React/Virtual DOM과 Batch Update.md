## 가상돔 (Virtual DOM)

HTML 파싱해서 DOM 트리를 그립니다.
DOM API를 사용해서 DOM 조작하는데, 레이아웃이나 색상이 바뀌면 리플로우와 리펜인트가 발생합니다.
이때, DOM 전체를 다시 그리는데 많은 비용이 발생합니다.

React는 가상돔을 사용해서 리플로우 리페인트 과정을 최소화하여 성능을 향상시킵니다.
업데이트 되기 전 가상돔을 캡처해서 메모리에 유지하고, 업데이트 된 가상돔과 비교해서(diffing) 변경된 부분만 실제 DOM에 반영합니다. (reconciliation)

이런 방식으로 전체 DOM 트리를 재구축하지 않고, 필요한 부분만 빠르게 업데이트해서 렌더링 성능을 향상됩니다.

## Batch Update

React는 State가 변경되었을 때, 바로 State를 업데이트하여 랜더링하지 않습니다.
변경사항을 적용할 때, 일정 시간 동안 변경사항을 모아서 한번에 적용하는 방식(Batch Update)을 사용해서 리랜더링을 최소화합니다.

그래서 setState는 동기적으로 처리되지 않고, 비동기적으로 처리됩니다. setState가 호출돼도 바로 랜더링이 발생하지 않습니다. setState() 메서드를 사용할 때에는, 배치 업데이트가 일어나는 시점을 고려하여 코드를 작성해야 합니다.

> React 17 및 이전 버전은 브라우저 이벤트에 대한 일괄 처리만 지원합니다. 그러나 React 18 업데이트에서는 자동 배칭이라는 향상된 배칭 버전을 도입했다.
> 이렇게 하면 출처에 관계없이 모든 상태 업데이트에 대한 일괄 처리가 활성화됩니다.

## fluxSync 매서드

만약 setState를 동기적으로 처리해서 바로 랜더링을 하고 싶다면, react-router-dom의 fluxSync 매서드를 사용할 수 있습니다. 하지만, 공식문서에서는 flushSync 사용은 앱 성능에 부정적인 영향을 줄 수 있으니 권장하진 않습니다.

> flushSyncReact가 제공된 콜백 내부의 모든 업데이트를 동기적으로 플러시하도록 강제할 수 있습니다. 이렇게 하면 DOM이 즉시 업데이트됩니다.
>
> ```js
> flushSync(callback);
> ```
